{% extends 'base.html' %}
{% load static %}

{% block title %}
    <title>Map</title>
    <meta charset='utf-8' />
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.52.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.52.0/mapbox-gl.css' rel='stylesheet' />
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
{% endblock title %}
    
{% block content %}

<div id='map'></div>

<script>

MapToken = 'pk.eyJ1IjoicGVkcm9sYXZpY3RvciIsImEiOiJjazgzeGU0ZzAwNDh3M2ZtcnAzM2dhcDVqIn0.lAbM_sMMIogn7qPyX1bi4w';
mapStyle = "{% static 'json/mapStyle.json' %}"

mapboxgl.accessToken = MapToken;


var map = new mapboxgl.Map({
    container: 'map', // container id
    style: 'mapbox://styles/pedrolavictor/ck8m6k9e30nvp1ilct2to4ac2', // stylesheet location
    center: [-74.50, 40], // starting position [lng, lat]
    zoom: 9 // starting zoom
});

var url = 'https://wanderdrone.appspot.com/';
map.on('load', function() {
    window.setInterval(function() {
        map.getSource('drone').setData(url);
    }, 2000);
    
    map.addSource('drone', { type: 'geojson', data: url });
    map.addLayer({
        'id': 'drone',
        'type': 'symbol',
        'source': 'drone',
        'layout': {
        'icon-image': 'rocket-15'
        }
    });
});


</script>

{% endblock content %}